<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>bigscreenenergy</title>
  <style>
    /* Force hidden display on specified elements, overriding other styles */
    #docs-chrome,
    div[role="navigation"],
    div[id*="-row-headers-background"],
    div[id*="-column-headers-background"],
    iframe#core-js-error-dialog,
    div#core-js-error-dialog-overlay,
    thead,
    th {
      display: none !important;
    }
    
    /* Basic sticky row styling – additional top offsets are set dynamically */
    table.waffle tbody tr.sticky-row {
      position: sticky !important;
      background: white;
      z-index: 2; /* Ensure they appear above the scrolling content */
    }
  </style>
  <!-- Include jQuery from a CDN -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function(){
      $.ajax({
        url: "https://docs.google.com/spreadsheets/d/19jg_ZMehXnoGWQj-yDOyXTw3uAOiGBw5GOZnx7lE3JE/edit",
        type: "GET",
        dataType: "html",
        success: function(data) {
          // Insert the fetched content into the container
          $("#sheet-data").html(data);
          
          // Locate each table with class 'waffle' in the loaded content
          $("table.waffle tbody").each(function(){
            var $tbody = $(this);
            // Find the first row that contains a th element with the specified classes.
            // This row serves as the marker—rows above it will be fixed via sticky positioning.
            var $markerRow = $tbody.find("tr").filter(function(){
              return $(this).find("th.freezebar-cell.freezebar-horizontal-handle").length > 0;
            }).first();
            
            if ($markerRow.length) {
              // Select all rows preceding the marker row.
              // .prevAll() returns them in reverse order so we reverse the order to maintain the flow.
              var $stickyRows = $markerRow.prevAll().get().reverse();
              // Compute cumulative offset so that each sticky row is positioned below the previous one.
              var cumulativeOffset = 0;
              $($stickyRows).each(function(){
                $(this).addClass("sticky-row").css({
                  position: "sticky",
                  top: cumulativeOffset + "px",
                  "z-index": 2,
                  background: "white"
                });
                cumulativeOffset += $(this).outerHeight();
              });
            }
          });
        },
        error: function(jqXHR, textStatus, errorThrown) {
          console.error("Error loading Google Sheets data:", textStatus, errorThrown);
          $("#sheet-data").html("<p>Error loading data. Please try again later.</p>");
        }
      });
    });
  </script>
</head>
<body>
  <div id="sheet-data">
    <p>Coming soon, to a theatre near you...</p>
  </div>
</body>
</html>
