<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>bigscreenenergy</title>
  <style>
    /* Force hidden display on specified elements, overriding other styles */
    #docs-chrome,
    div[role="navigation"],
    div[id*="-row-headers-background"],
    div[id*="-column-headers-background"],
    iframe#core-js-error-dialog,
    div#core-js-error-dialog-overlay,
    thead,
    th {
      display: none !important;
    }
    
    /* Basic sticky row styling â€“ additional top offsets are set dynamically */
    table.waffle tbody tr.sticky-row {
      position: sticky !important;
      background: white;
      z-index: 2; /* Ensure they appear above scrolling content */
    }
  </style>
  
  <!-- Include jQuery from a CDN -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    // Prevent any JavaScript redirects by overriding redirection methods.
    (function() {
      const noop = function(url) {
        console.log("Redirect prevented to:", url);
      };
      // Override the common redirection methods.
      window.location.assign   = noop;
      window.location.replace  = noop;
      window.location.reload   = noop;
      
      // Attempt to override directly setting window.location (if possible)
      try {
        Object.defineProperty(window, "location", {
          configurable: true,
          enumerable: true,
          get: function() { return document.location; },
          set: function(value) {
            console.log("Prevented redirect to:", value);
          }
        });
      } catch(e) {
        console.warn("Failed to override window.location setter:", e);
      }
    })();
  </script>
  
  <script>
    $(document).ready(function(){
      $.ajax({
        url: "https://docs.google.com/spreadsheets/d/19jg_ZMehXnoGWQj-yDOyXTw3uAOiGBw5GOZnx7lE3JE/edit",
        type: "GET",
        dataType: "html",
        success: function(data) {
          // Insert the fetched content into the container
          $("#sheet-data").html(data);
          
          // Locate each table with class 'waffle' in the loaded content
          $("table.waffle tbody").each(function(){
            var $tbody = $(this);
            // Find the first row that contains a th element with the specific classes.
            var $markerRow = $tbody.find("tr").filter(function(){
              return $(this).find("th.freezebar-cell.freezebar-horizontal-handle").length > 0;
            }).first();
            
            if ($markerRow.length) {
              // Select all rows preceding the marker row.
              var $stickyRows = $markerRow.prevAll().get().reverse();
              // Compute cumulative offset to stack each sticky row below the previous one.
              var cumulativeOffset = 0;
              $($stickyRows).each(function(){
                $(this).addClass("sticky-row").css({
                  position: "sticky",
                  top: cumulativeOffset + "px",
                  "z-index": 2,
                  background: "white"
                });
                cumulativeOffset += $(this).outerHeight();
              });
            }
          });
        },
        error: function(jqXHR, textStatus, errorThrown) {
          console.error("Error loading Google Sheets data:", textStatus, errorThrown);
          $("#sheet-data").html("<p>Error loading data. Please try again later.</p>");
        }
      });
    });
  </script>
</head>
<body>
  <div id="sheet-data">
    <p>Coming soon, to a theatre near you...</p>
  </div>
</body>
</html>
